(this["webpackJsonpmap-route"]=this["webpackJsonpmap-route"]||[]).push([[0],{13:function(e,t,n){e.exports={newPointForm:"NewPointForm_newPointForm__1hnJv",newPointForm__input:"NewPointForm_newPointForm__input__3Q_aj",newPointForm__input_error:"NewPointForm_newPointForm__input_error__19Ma6",newPointForm__errorText:"NewPointForm_newPointForm__errorText__ZFnEV"}},19:function(e,t,n){e.exports={mapRouting:"MapRouting_mapRouting__3xr0e",mapRouting__map:"MapRouting_mapRouting__map__2Uvlm",mapRouting__points:"MapRouting_mapRouting__points__1vPHg"}},24:function(e,t,n){},27:function(e,t){e.exports="data:image/png;base64,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"},29:function(e,t,n){e.exports={map:"Map_map__224Xh"}},31:function(e,t,n){e.exports=n(41)},41:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(4),i=n.n(o),c=(n(24),n(12)),A=n(19),u=n.n(A),s=n(11),d=n(18),l=n(13),p=n.n(l),m=n(26),f=n.n(m),P=Object(r.memo)((function(e){var t=e.addNewPoint,n=e.isNoPointInCenter,o=Object(r.useState)(""),i=Object(c.a)(o,2),A=i[0],u=i[1],s=Object(r.useState)(""),l=Object(c.a)(s,2),m=l[0],P=l[1],b=m&&!n||"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0442\u043e\u0447\u043a\u0438"===m;return a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),A&&n&&(t(A),u(""),P("")),A||P("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0442\u043e\u0447\u043a\u0438")},id:"newPointForm",className:p.a.newPointForm},a.a.createElement("input",{name:"newPoint",type:"text",autoComplete:"off",onChange:function(e){u(e.target.value),e.target.value&&!n?P("\u0412 \u044d\u0442\u043e\u043c \u043c\u0435\u0441\u0442\u0435 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430"):P("")},value:A,id:"newPointInput",title:"\u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0432 \u0446\u0435\u043d\u0442\u0440\u0435 \u043a\u0430\u0440\u0442\u044b",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u0443\u044e \u0442\u043e\u0447\u043a\u0443 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430",className:f()(p.a.newPointForm__input,Object(d.a)({},p.a.newPointForm__input_error,b))}),b&&a.a.createElement("div",{className:p.a.newPointForm__errorText},m))})),b=n(6),j=n.n(b),_=n(7),w=n.n(_),E=n(10),O=n(2),v=n(15),N={getAddressFromCoordinates:function(){var e=Object(E.a)(w.a.mark((function e(t,n){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.geocode(n);case 3:return r=e.sent,e.abrupt("return",r.geoObjects.get(0).getAddressLine());case 7:throw e.prev=7,e.t0=e.catch(0),alert("\u041d\u0435 \u0432\u044b\u0445\u043e\u0434\u0438\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0430\u0434\u0440\u0435\u0441 \u0442\u043e\u0447\u043a\u0438, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435"),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},g={routeArray:[],yandexMapState:{center:[55.75,37.57],zoom:9},yMaps:null,pointIsFetching:{reason:null,newPointName:null,movedMarker:{id:null,newCoordinates:null}},isNoPointInCenter:!0},I=function(e){var t=-1;return e.isNoPointInCenter||(t=Math.max.apply(Math,Object(v.a)(e.routeArray.map((function(e){return e.id}))))),t},x=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"ADD_POINT":var r=0;return t.routeArray.forEach((function(e){r<e.id&&(r=e.id)})),Object(O.a)(Object(O.a)({},t),{},{routeArray:[].concat(Object(v.a)(t.routeArray),[Object(O.a)(Object(O.a)({},n.payload),{},{coordinates:t.yandexMapState.center,id:r+1})]),isNoPointInCenter:!1});case"DELETE_POINT":return e=I(t),Object(O.a)(Object(O.a)({},t),{},{isNoPointInCenter:e===n.id||t.isNoPointInCenter,routeArray:t.routeArray.filter((function(e){return e.id!==n.id}))});case"SET_POINT_IS_FETCHING":return Object(O.a)(Object(O.a)({},t),{},{pointIsFetching:{reason:n.payload.reason,newPointName:n.payload.newPointName,movedMarker:{id:n.payload.movedMarkerId,newCoordinates:n.payload.newCoordinates}}});case"UPDATE_POINT_COORDINATES":return e=I(t),Object(O.a)(Object(O.a)({},t),{},{isNoPointInCenter:e===n.payload.id||t.isNoPointInCenter,routeArray:t.routeArray.map((function(e){return n.payload.id!==e.id?e:Object(O.a)(Object(O.a)(Object(O.a)({},e),n.payload),{},{coordinates:Object(v.a)(n.payload.coordinates)})}))});case"CHANGE_POINTS_ORDER":var a=Object(v.a)(t.routeArray),o=Object(O.a)({},t.routeArray[n.sourceIndex]);return a.splice(n.sourceIndex,1),a.splice(n.destIndex,0,o),Object(O.a)(Object(O.a)({},t),{},{routeArray:a});case"UPDATE_MAP_CENTER":return Object(O.a)(Object(O.a)({},t),{},{yandexMapState:n.payload,isNoPointInCenter:!0});case"SET_YMAPS":return Object(O.a)(Object(O.a)({},t),{},{yMaps:n.yMaps});default:return t}},y=function(e,t){return{type:"ADD_POINT",payload:{name:e,addr:t}}},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:"SET_POINT_IS_FETCHING",payload:{reason:e,newPointName:t,newCoordinates:n,movedMarkerId:r}}},C=function(e){return{type:"DELETE_POINT",id:e}},T=function(e,t){return{type:"CHANGE_POINTS_ORDER",sourceIndex:e,destIndex:t}},h=function(e,t){return{type:"UPDATE_MAP_CENTER",payload:{center:e,zoom:t}}},D=function(e,t,n){return{type:"UPDATE_POINT_COORDINATES",payload:{id:n,coordinates:e,addr:t}}},M=function(e){return{type:"SET_YMAPS",yMaps:e}},z=function(){var e=Object(E.a)(w.a.mark((function e(t,n,r,a,o){var i,c,A,u;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.getAddressFromCoordinates(t,n);case 3:i=e.sent,a(D(n,i,r)),e.next=13;break;case 7:e.prev=7,e.t0=e.catch(0),c=o.filter((function(e){return r===e.id}))[0],A=c.coordinates,u=c.addr,a(D(A,u,r));case 13:return e.prev=13,a(R(null)),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,7,13,16]])})));return function(t,n,r,a,o){return e.apply(this,arguments)}}(),k=function(){var e=Object(E.a)(w.a.mark((function e(t,n,r,a){var o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.getAddressFromCoordinates(t,n);case 3:o=e.sent,r(y(a,o)),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:return e.prev=9,r(R(null)),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,7,9,12]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),J=n(27),H=n.n(J),B=function(e){var t=e.name,n=e.addr,r=e.id,o=e.index,i=e.dispatch,c=function(){i(C(r))};return a.a.createElement(s.b,{draggableId:r.toString(),index:o},(function(e){return a.a.createElement("div",Object.assign({className:j.a.routeItem,ref:e.innerRef},e.draggableProps),a.a.createElement("img",Object.assign({},e.dragHandleProps,{src:H.a,alt:"",className:j.a.routeItem__handle})),a.a.createElement("div",{className:j.a.routeItem__text},a.a.createElement("p",{className:j.a.routeItem__name},t),a.a.createElement("p",{className:j.a.routeItem__address},n)),a.a.createElement("span",{onClick:c,className:j.a.routeItem__delete}))}))},F=n(44),W=n(43),V=Object(r.memo)((function(e){var t=e.dispatch,n=e.routeArray,o=e.isNoPointInCenter,i=Object(r.useCallback)((function(e){var n=e.destination,r=e.reason,a=e.source;n&&n.index!==a.index&&"CANCEL"!==r&&t(T(a.index,n.index))}),[t]),c=Object(r.useCallback)((function(e){t(R("NEW_POINT",e))}),[t]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(P,{addNewPoint:c,isNoPointInCenter:o}),0===n.length&&a.a.createElement("p",{className:j.a.noPointText},"\u0422\u043e\u0447\u0435\u043a \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0430 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442"),a.a.createElement(s.a,{onDragEnd:i},a.a.createElement(s.c,{droppableId:"RouteList"},(function(e){return a.a.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),a.a.createElement(F.a,{className:"point-list"},n.map((function(e,n){return a.a.createElement(W.a,{key:e.id.toString(),timeout:400,classNames:"pointItem"},a.a.createElement(B,Object.assign({},e,{index:n,dispatch:t})))})),e.placeholder))}))))})),S=n(29),q=n.n(S),G=n(14),K=Object(r.memo)((function(e){var t=e.dispatch,n=e.routeArray,o=e.mapState,i=Object(r.useCallback)((function(e){t(M(e))}),[t]),c=Object(r.useCallback)((function(e){t(h(e.originalEvent.newCenter,e.originalEvent.newZoom))}),[t]),A=Object(r.useCallback)((function(e,n){var r=n.get("target").geometry.getCoordinates();t(R("UPDATE_COORDINATES",null,r,e))}),[t]);return a.a.createElement(G.d,{query:{apikey:"85158385-1882-447a-a9fb-85b7dc0c94ff"}},a.a.createElement(G.a,{className:q.a.map,state:o,modules:["geocode"],onBoundsChange:c,onLoad:i},n.map((function(e){return a.a.createElement(G.b,{geometry:e.coordinates,modules:["geoObject.addon.balloon"],options:{draggable:!0},onDragEnd:A.bind(null,e.id),properties:{balloonContent:e.name},key:e.id.toString(),id:e.id.toString(),placemarkTestId:"placemark"})})),a.a.createElement(G.c,{geometry:n.map((function(e){return e.coordinates})),options:{strokeColor:"#050",strokeWidth:2,strokeOpacity:.5}})))})),L=function(){var e=Object(r.useReducer)(x,g),t=Object(c.a)(e,2),n=t[0],o=t[1],i=n.pointIsFetching,A=n.routeArray,s=n.yMaps,d=n.yandexMapState;return Object(r.useEffect)((function(){var e=i.reason,t=i.newPointName,n=i.movedMarker;"NEW_POINT"===e&&s&&t?k(s,d.center,o,t):"UPDATE_COORDINATES"===e&&s&&n.newCoordinates&&n.id&&z(s,n.newCoordinates,n.id,o,A)}),[i]),a.a.createElement("main",{className:u.a.mapRouting},a.a.createElement("div",{className:u.a.mapRouting__points},a.a.createElement(V,{dispatch:o,routeArray:n.routeArray,isNoPointInCenter:n.isNoPointInCenter})),a.a.createElement("div",{className:u.a.mapRouting__map},a.a.createElement(K,{dispatch:o,routeArray:n.routeArray,mapState:n.yandexMapState})))},X=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(L,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){e.exports={routeItem:"RoutePoints_routeItem__nG6mK",routeItem__handle:"RoutePoints_routeItem__handle__1294p",routeItem__name:"RoutePoints_routeItem__name__PtKJd",routeItem__address:"RoutePoints_routeItem__address__2vUIj",routeItem__text:"RoutePoints_routeItem__text__3idm-",routeItem__delete:"RoutePoints_routeItem__delete__F8oYc",noPointText:"RoutePoints_noPointText__2tW2n"}}},[[31,1,2]]]);
//# sourceMappingURL=main.85c38988.chunk.js.map